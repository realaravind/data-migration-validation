{
  "query_count": 14,
  "total_executions": 12260,
  "date_range": {
    "start": "2024-12-01T10:30:00",
    "end": "2024-12-02T00:30:00"
  },
  "queries": [
    {
      "query_id": 1,
      "raw_text": "SELECT COUNT(*) FROM DIM.dim_customer",
      "stats": {
        "total_executions": 1250,
        "avg_duration": 45.3,
        "last_execution_time": "2024-12-01T10:30:00"
      }
    },
    {
      "query_id": 2,
      "raw_text": "SELECT COUNT(*) FROM DIM.dim_product",
      "stats": {
        "total_executions": 980,
        "avg_duration": 38.7,
        "last_execution_time": "2024-12-01T11:15:00"
      }
    },
    {
      "query_id": 3,
      "raw_text": "SELECT COUNT(*) FROM DIM.dim_store",
      "stats": {
        "total_executions": 850,
        "avg_duration": 32.1,
        "last_execution_time": "2024-12-01T11:45:00"
      }
    },
    {
      "query_id": 4,
      "raw_text": "SELECT COUNT(*) FROM FACT.fact_sales",
      "stats": {
        "total_executions": 2100,
        "avg_duration": 125.5,
        "last_execution_time": "2024-12-01T12:00:00"
      }
    },
    {
      "query_id": 5,
      "raw_text": "SELECT * FROM DIM.dim_product WHERE category = 'Electronics'",
      "stats": {
        "total_executions": 680,
        "avg_duration": 28.3,
        "last_execution_time": "2024-12-01T13:30:00"
      }
    },
    {
      "query_id": 6,
      "raw_text": "SELECT AVG(unit_price) FROM DIM.dim_product",
      "stats": {
        "total_executions": 890,
        "avg_duration": 42.3,
        "last_execution_time": "2024-12-01T15:00:00"
      }
    },
    {
      "query_id": 7,
      "raw_text": "SELECT p.product_name, s.quantity FROM DIM.dim_product p INNER JOIN FACT.fact_sales s ON p.product_key = s.dim_product_key",
      "stats": {
        "total_executions": 1350,
        "avg_duration": 223.4,
        "last_execution_time": "2024-12-01T16:30:00"
      }
    },
    {
      "query_id": 8,
      "raw_text": "SELECT category, COUNT(*) FROM DIM.dim_product GROUP BY category",
      "stats": {
        "total_executions": 650,
        "avg_duration": 56.8,
        "last_execution_time": "2024-12-01T18:00:00"
      }
    },
    {
      "query_id": 9,
      "raw_text": "SELECT * FROM DIM.dim_product ORDER BY unit_price DESC",
      "stats": {
        "total_executions": 490,
        "avg_duration": 67.4,
        "last_execution_time": "2024-12-01T19:00:00"
      }
    },
    {
      "query_id": 10,
      "raw_text": "SELECT c.customer_name, p.product_name, s.discount_amount FROM DIM.dim_customer c INNER JOIN FACT.fact_sales s ON c.customer_key = s.dim_customer_key INNER JOIN DIM.dim_product p ON s.dim_product_key = p.product_key WHERE s.discount_amount > 1000",
      "stats": {
        "total_executions": 890,
        "avg_duration": 312.8,
        "last_execution_time": "2024-12-01T20:00:00"
      }
    },
    {
      "query_id": 11,
      "raw_text": "SELECT DISTINCT category FROM DIM.dim_product",
      "stats": {
        "total_executions": 420,
        "avg_duration": 48.2,
        "last_execution_time": "2024-12-01T20:30:00"
      }
    },
    {
      "query_id": 12,
      "raw_text": "SELECT * FROM DIM.dim_product WHERE unit_price > 100 AND unit_price < 500",
      "stats": {
        "total_executions": 580,
        "avg_duration": 52.1,
        "last_execution_time": "2024-12-01T21:00:00"
      }
    },
    {
      "query_id": 13,
      "raw_text": "SELECT * FROM DIM.dim_product WHERE category IN ('Electronics', 'Clothing', 'Food')",
      "stats": {
        "total_executions": 460,
        "avg_duration": 43.5,
        "last_execution_time": "2024-12-01T22:00:00"
      }
    },
    {
      "query_id": 14,
      "raw_text": "SELECT p.category, COUNT(*) AS ProductCount, AVG(p.unit_price) AS AvgPrice, SUM(ISNULL(s.quantity, 0)) AS TotalSold FROM DIM.dim_product p LEFT JOIN FACT.fact_sales s ON p.product_key = s.dim_product_key GROUP BY p.category",
      "stats": {
        "total_executions": 670,
        "avg_duration": 289.4,
        "last_execution_time": "2024-12-02T00:30:00"
      }
    }
  ],
  "patterns": [
    {
      "query_id": "1",
      "tables": [
        "dim_customer"
      ],
      "columns": {
        "dim_customer": [
          "COUNT(*)"
        ]
      },
      "joins": [],
      "where_columns": [],
      "aggregations": [],
      "group_by_columns": [],
      "order_by_columns": [],
      "has_distinct": false,
      "query_type": "SELECT",
      "total_executions": 1250,
      "avg_duration": 45.3
    },
    {
      "query_id": "2",
      "tables": [
        "dim_product"
      ],
      "columns": {
        "dim_product": [
          "COUNT(*)"
        ]
      },
      "joins": [],
      "where_columns": [],
      "aggregations": [],
      "group_by_columns": [],
      "order_by_columns": [],
      "has_distinct": false,
      "query_type": "SELECT",
      "total_executions": 980,
      "avg_duration": 38.7
    },
    {
      "query_id": "3",
      "tables": [
        "dim_store"
      ],
      "columns": {
        "dim_store": [
          "COUNT(*)"
        ]
      },
      "joins": [],
      "where_columns": [],
      "aggregations": [],
      "group_by_columns": [],
      "order_by_columns": [],
      "has_distinct": false,
      "query_type": "SELECT",
      "total_executions": 850,
      "avg_duration": 32.1
    },
    {
      "query_id": "4",
      "tables": [
        "fact_sales"
      ],
      "columns": {
        "fact_sales": [
          "COUNT(*)"
        ]
      },
      "joins": [],
      "where_columns": [],
      "aggregations": [],
      "group_by_columns": [],
      "order_by_columns": [],
      "has_distinct": false,
      "query_type": "SELECT",
      "total_executions": 2100,
      "avg_duration": 125.5
    },
    {
      "query_id": "5",
      "tables": [
        "dim_product"
      ],
      "columns": {},
      "joins": [],
      "where_columns": [],
      "aggregations": [],
      "group_by_columns": [],
      "order_by_columns": [],
      "has_distinct": false,
      "query_type": "SELECT",
      "total_executions": 680,
      "avg_duration": 28.3
    },
    {
      "query_id": "6",
      "tables": [
        "dim_product"
      ],
      "columns": {
        "dim_product": [
          "AVG(unit_price)"
        ]
      },
      "joins": [],
      "where_columns": [],
      "aggregations": [
        [
          "",
          "unit_price",
          "AVG"
        ]
      ],
      "group_by_columns": [],
      "order_by_columns": [],
      "has_distinct": false,
      "query_type": "SELECT",
      "total_executions": 890,
      "avg_duration": 42.3
    },
    {
      "query_id": "7",
      "tables": [
        "dim_product",
        "fact_sales"
      ],
      "columns": {
        "p": [
          "product_name"
        ],
        "s": [
          "quantity"
        ]
      },
      "joins": [],
      "where_columns": [],
      "aggregations": [],
      "group_by_columns": [],
      "order_by_columns": [],
      "has_distinct": false,
      "query_type": "SELECT",
      "total_executions": 1350,
      "avg_duration": 223.4
    },
    {
      "query_id": "8",
      "tables": [
        "category",
        "dim_product"
      ],
      "columns": {
        "category": [
          "category",
          "COUNT(*)"
        ]
      },
      "joins": [],
      "where_columns": [],
      "aggregations": [],
      "group_by_columns": [
        [
          "",
          "category"
        ]
      ],
      "order_by_columns": [],
      "has_distinct": false,
      "query_type": "SELECT",
      "total_executions": 650,
      "avg_duration": 56.8
    },
    {
      "query_id": "9",
      "tables": [
        "unit_price",
        "dim_product"
      ],
      "columns": {},
      "joins": [],
      "where_columns": [],
      "aggregations": [],
      "group_by_columns": [],
      "order_by_columns": [
        [
          "",
          "unit_price"
        ]
      ],
      "has_distinct": false,
      "query_type": "SELECT",
      "total_executions": 490,
      "avg_duration": 67.4
    },
    {
      "query_id": "10",
      "tables": [
        "dim_customer",
        "dim_product",
        "fact_sales"
      ],
      "columns": {
        "c": [
          "customer_name"
        ],
        "p": [
          "product_name"
        ],
        "s": [
          "discount_amount"
        ]
      },
      "joins": [],
      "where_columns": [
        [
          "s",
          "discount_amount",
          ">"
        ]
      ],
      "aggregations": [],
      "group_by_columns": [],
      "order_by_columns": [],
      "has_distinct": false,
      "query_type": "SELECT",
      "total_executions": 890,
      "avg_duration": 312.8
    },
    {
      "query_id": "11",
      "tables": [
        "dim_product"
      ],
      "columns": {
        "dim_product": [
          "DISTINCT"
        ]
      },
      "joins": [],
      "where_columns": [],
      "aggregations": [],
      "group_by_columns": [],
      "order_by_columns": [],
      "has_distinct": true,
      "query_type": "SELECT",
      "total_executions": 420,
      "avg_duration": 48.2
    },
    {
      "query_id": "12",
      "tables": [
        "dim_product"
      ],
      "columns": {},
      "joins": [],
      "where_columns": [],
      "aggregations": [],
      "group_by_columns": [],
      "order_by_columns": [],
      "has_distinct": false,
      "query_type": "SELECT",
      "total_executions": 580,
      "avg_duration": 52.1
    },
    {
      "query_id": "13",
      "tables": [
        "dim_product"
      ],
      "columns": {},
      "joins": [],
      "where_columns": [],
      "aggregations": [],
      "group_by_columns": [],
      "order_by_columns": [],
      "has_distinct": false,
      "query_type": "SELECT",
      "total_executions": 460,
      "avg_duration": 43.5
    },
    {
      "query_id": "14",
      "tables": [
        "category",
        "dim_product",
        "fact_sales"
      ],
      "columns": {
        "p": [
          "category"
        ],
        "category": [
          "COUNT(*)",
          "AVG(p.unit_price)",
          "0))"
        ],
        "SUM(ISNULL(s": [
          "quantity"
        ]
      },
      "joins": [],
      "where_columns": [],
      "aggregations": [
        [
          "p",
          "unit_price",
          "AVG"
        ]
      ],
      "group_by_columns": [
        [
          "p",
          "category"
        ]
      ],
      "order_by_columns": [],
      "has_distinct": false,
      "query_type": "SELECT",
      "total_executions": 670,
      "avg_duration": 289.4
    }
  ],
  "table_usage": {
    "dim_customer": {
      "table_name": "dim_customer",
      "schema_name": "",
      "access_count": 2140,
      "join_partners": [],
      "columns_used": {}
    },
    "dim_product": {
      "table_name": "dim_product",
      "schema_name": "",
      "access_count": 8060,
      "join_partners": [],
      "columns_used": {
        "unit_price": {
          "column_name": "unit_price",
          "table_name": "dim_product",
          "usage_types": [
            "aggregate"
          ],
          "aggregate_functions": [
            "AVG"
          ],
          "operators": [],
          "query_count": 1
        },
        "category": {
          "column_name": "category",
          "table_name": "dim_product",
          "usage_types": [
            "group_by"
          ],
          "aggregate_functions": [],
          "operators": [],
          "query_count": 1
        }
      }
    },
    "dim_store": {
      "table_name": "dim_store",
      "schema_name": "",
      "access_count": 850,
      "join_partners": [],
      "columns_used": {}
    },
    "fact_sales": {
      "table_name": "fact_sales",
      "schema_name": "",
      "access_count": 5010,
      "join_partners": [],
      "columns_used": {}
    },
    "category": {
      "table_name": "category",
      "schema_name": "",
      "access_count": 1320,
      "join_partners": [],
      "columns_used": {
        "category": {
          "column_name": "category",
          "table_name": "category",
          "usage_types": [
            "group_by"
          ],
          "aggregate_functions": [],
          "operators": [],
          "query_count": 1
        }
      }
    },
    "unit_price": {
      "table_name": "unit_price",
      "schema_name": "",
      "access_count": 490,
      "join_partners": [],
      "columns_used": {}
    }
  },
  "workload_id": "wl_20251202_074924_d42d6bea",
  "project_id": "dw",
  "upload_date": "2025-12-02T07:49:24.527186",
  "analysis": {
    "tables": {
      "dim_customer": {
        "access_count": 2140,
        "query_count": 2,
        "suggestions": [],
        "join_partners": [],
        "column_usage": {}
      },
      "dim_product": {
        "access_count": 8060,
        "query_count": 11,
        "suggestions": [
          {
            "validator_name": "validate_cardinality",
            "table_name": "dim_product",
            "schema_name": "",
            "columns": [
              "category"
            ],
            "confidence": 0.5900000000000001,
            "reason": "Column used in GROUP BY of 1 queries (likely categorical/dimension key)",
            "query_count": 1,
            "total_executions": 8060,
            "source": "workload",
            "metadata": {
              "usage_type": "grouping"
            }
          }
        ],
        "join_partners": [],
        "column_usage": {
          "unit_price": {
            "usage_types": [
              "aggregate"
            ],
            "query_count": 1,
            "aggregate_functions": [
              "AVG"
            ],
            "operators": []
          },
          "category": {
            "usage_types": [
              "group_by"
            ],
            "query_count": 1,
            "aggregate_functions": [],
            "operators": []
          }
        }
      },
      "dim_store": {
        "access_count": 850,
        "query_count": 1,
        "suggestions": [],
        "join_partners": [],
        "column_usage": {}
      },
      "fact_sales": {
        "access_count": 5010,
        "query_count": 4,
        "suggestions": [],
        "join_partners": [],
        "column_usage": {}
      },
      "category": {
        "access_count": 1320,
        "query_count": 2,
        "suggestions": [
          {
            "validator_name": "validate_cardinality",
            "table_name": "category",
            "schema_name": "",
            "columns": [
              "category"
            ],
            "confidence": 0.5900000000000001,
            "reason": "Column used in GROUP BY of 1 queries (likely categorical/dimension key)",
            "query_count": 1,
            "total_executions": 1320,
            "source": "workload",
            "metadata": {
              "usage_type": "grouping"
            }
          }
        ],
        "join_partners": [],
        "column_usage": {
          "category": {
            "usage_types": [
              "group_by"
            ],
            "query_count": 1,
            "aggregate_functions": [],
            "operators": []
          }
        }
      },
      "unit_price": {
        "access_count": 490,
        "query_count": 1,
        "suggestions": [],
        "join_partners": [],
        "column_usage": {}
      }
    },
    "coverage": {
      "total_queries": 14,
      "queries_covered": 1,
      "coverage_percentage": 7.14,
      "total_executions_covered": 9380,
      "validation_count": 2,
      "high_confidence_count": 0,
      "medium_confidence_count": 0,
      "low_confidence_count": 2
    },
    "categories": {
      "referential_integrity": [],
      "data_quality": [],
      "statistics": [],
      "distribution": [],
      "time_series": [
        {
          "validator_name": "validate_cardinality",
          "table_name": "dim_product",
          "schema_name": "",
          "columns": [
            "category"
          ],
          "confidence": 0.5900000000000001,
          "reason": "Column used in GROUP BY of 1 queries (likely categorical/dimension key)",
          "query_count": 1,
          "total_executions": 8060,
          "source": "workload",
          "metadata": {
            "usage_type": "grouping"
          }
        },
        {
          "validator_name": "validate_cardinality",
          "table_name": "category",
          "schema_name": "",
          "columns": [
            "category"
          ],
          "confidence": 0.5900000000000001,
          "reason": "Column used in GROUP BY of 1 queries (likely categorical/dimension key)",
          "query_count": 1,
          "total_executions": 1320,
          "source": "workload",
          "metadata": {
            "usage_type": "grouping"
          }
        }
      ],
      "cardinality": [],
      "value_range": []
    },
    "analyzed_at": "2025-12-02T07:49:24.546022"
  },
  "last_updated": "2025-12-02T07:49:24.546401"
}