metadata:
  name: fact_sales_workload_validation
  description: Workload-based validations for fact_sales
  generated_from: workload_wl_20260112_062801_511ea13b
  project_id: default_project
  created_at: '2026-01-12T06:28:19.655208'
  validation_count: 2
  active: true
source:
  type: sqlserver
  database: ${SQL_DATABASE}
  schema: sample_fact
  table: fact_sales
target:
  type: snowflake
  database: ${SNOWFLAKE_DATABASE}
  schema: SAMPLE_FACT
  table: FACT_SALES
steps:
- name: validation_1_workload_query
  type: comparative
  description: Actual workload query (executed 2150 times)
  confidence: 95.0
  enabled: true
  validator: custom_sql
  config:
    sql_query: SELECT d.month_name, SUM(f.total_amount) as total_sales, COUNT(*) as
      order_count FROM sample_fact.fact_sales f INNER JOIN sample_dim.dim_date d ON
      f.dim_date_key = d.date_key GROUP BY d.month_name ORDER BY total_sales DESC
    snow_query: SELECT d.month_name, SUM(f.total_amount) as total_sales, COUNT(*)
      as order_count FROM SAMPLE_FACT.FACT_SALES f INNER JOIN SAMPLE_DIM.DIM_DATE
      d ON f.dim_date_key = d.date_key GROUP BY d.month_name ORDER BY total_sales
      DESC
    compare_mode: result_set
    tolerance: 0.01
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 2
    validation_type: workload_query
    total_executions: 0
    avg_duration_ms: 187.6
- name: validation_2_workload_query
  type: comparative
  description: Actual workload query (executed 1820 times)
  confidence: 95.0
  enabled: true
  validator: custom_sql
  config:
    sql_query: SELECT c.customer_name, SUM(f.total_amount) as total_spent FROM sample_fact.fact_sales
      f INNER JOIN sample_dim.dim_customer c ON f.dim_customer_key = c.customer_key
      GROUP BY c.customer_name ORDER BY total_spent DESC
    snow_query: SELECT c.customer_name, SUM(f.total_amount) as total_spent FROM SAMPLE_FACT.FACT_SALES
      f INNER JOIN SAMPLE_DIM.DIM_CUSTOMER c ON f.dim_customer_key = c.customer_key
      GROUP BY c.customer_name ORDER BY total_spent DESC
    compare_mode: result_set
    tolerance: 0.01
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 3
    validation_type: workload_query
    total_executions: 0
    avg_duration_ms: 156.4
