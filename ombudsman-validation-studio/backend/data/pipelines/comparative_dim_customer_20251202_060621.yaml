metadata:
  name: dim_customer_comparative_validation
  description: Comparative validations from Query Store for dim.dim_customer
  generated_from: workload_wl_20251202_060618_1a4c017a
  project_id: dw_validation
  created_at: '2025-12-02T06:06:21.145675'
  validation_count: 8
  validation_type: comparative
source:
  type: sqlserver
  database: ${SQL_DATABASE}
  schema: dim
  table: dim_customer
target:
  type: snowflake
  database: ${SNOWFLAKE_DATABASE}
  schema: DIM
  table: DIM_CUSTOMER
steps:
- name: comparative_validation_1_query_1
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    1)'
  enabled: true
  config:
    sql_server_query: SELECT COUNT(*) FROM dim.DIM_CUSTOMER
    snowflake_query: SELECT COUNT(*) FROM DIM.DIM_CUSTOMER
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 1
    total_executions: 1250
    avg_duration_ms: 45.3
    last_execution_time: '2024-12-01T10:30:00'
- name: comparative_validation_2_query_6
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    6)'
  enabled: true
  config:
    sql_server_query: SELECT * FROM dim.DIM_CUSTOMER WHERE customer_id = 100
    snowflake_query: SELECT * FROM DIM.DIM_CUSTOMER WHERE CUSTOMER_ID = 100
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 6
    total_executions: 450
    avg_duration_ms: 12.5
    last_execution_time: '2024-12-01T13:00:00'
- name: comparative_validation_3_query_8
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    8)'
  enabled: true
  config:
    sql_server_query: SELECT * FROM dim.DIM_CUSTOMER WHERE customer_name LIKE 'John%'
    snowflake_query: SELECT * FROM DIM.DIM_CUSTOMER WHERE CUSTOMER_NAME LIKE 'John%'
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 8
    total_executions: 320
    avg_duration_ms: 45.8
    last_execution_time: '2024-12-01T14:00:00'
- name: comparative_validation_4_query_12
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    12)'
  enabled: true
  config:
    sql_server_query: SELECT c.customer_name, s.TotalAmount FROM dim.DIM_CUSTOMER
      c INNER JOIN fact.FACT_SALES s ON c.customer_id = s.customer_id
    snowflake_query: SELECT c.CUSTOMER_NAME, s.TotalAmount FROM DIM.DIM_CUSTOMER c
      INNER JOIN FACT.FACT_SALES s ON c.CUSTOMER_ID = s.CUSTOMER_ID
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 12
    total_executions: 1500
    avg_duration_ms: 245.6
    last_execution_time: '2024-12-01T16:00:00'
- name: comparative_validation_5_query_20
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    20)'
  enabled: true
  config:
    sql_server_query: SELECT c.customer_name, p.ProductName, s.TotalAmount FROM dim.DIM_CUSTOMER
      c INNER JOIN fact.FACT_SALES s ON c.customer_id = s.customer_id INNER JOIN dim.DIM_PRODUCT
      p ON s.ProductID = p.ProductID WHERE s.TotalAmount > 1000
    snowflake_query: SELECT c.CUSTOMER_NAME, p.ProductName, s.TotalAmount FROM DIM.DIM_CUSTOMER
      c INNER JOIN FACT.FACT_SALES s ON c.CUSTOMER_ID = s.CUSTOMER_ID INNER JOIN DIM.DIM_PRODUCT
      p ON s.ProductID = p.ProductID WHERE s.TotalAmount > 1000
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 20
    total_executions: 890
    avg_duration_ms: 312.8
    last_execution_time: '2024-12-01T20:00:00'
- name: comparative_validation_6_query_23
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    23)'
  enabled: true
  config:
    sql_server_query: SELECT * FROM dim.DIM_CUSTOMER WHERE email IS NOT NULL
    snowflake_query: SELECT * FROM DIM.DIM_CUSTOMER WHERE EMAIL IS NOT NULL
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 23
    total_executions: 340
    avg_duration_ms: 38.9
    last_execution_time: '2024-12-01T21:30:00'
- name: comparative_validation_7_query_28
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    28)'
  enabled: true
  config:
    sql_server_query: SELECT c.CustomerSegment, COUNT(DISTINCT c.customer_id) AS CustomerCount,
      SUM(s.TotalAmount) AS TotalRevenue FROM dim.DIM_CUSTOMER c LEFT JOIN fact.FACT_SALES
      s ON c.customer_id = s.customer_id GROUP BY c.CustomerSegment
    snowflake_query: SELECT c.CustomerSegment, COUNT(DISTINCT c.CUSTOMER_ID) AS CustomerCount,
      SUM(s.TotalAmount) AS TotalRevenue FROM DIM.DIM_CUSTOMER c LEFT JOIN FACT.FACT_SALES
      s ON c.CUSTOMER_ID = s.CUSTOMER_ID GROUP BY c.CustomerSegment
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 28
    total_executions: 530
    avg_duration_ms: 267.8
    last_execution_time: '2024-12-02T00:00:00'
- name: comparative_validation_8_query_30
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    30)'
  enabled: true
  config:
    sql_server_query: SELECT * FROM dim.DIM_CUSTOMER WHERE customer_id IN (SELECT
      DISTINCT customer_id FROM fact.FACT_SALES WHERE TotalAmount > 5000)
    snowflake_query: SELECT * FROM DIM.DIM_CUSTOMER WHERE CUSTOMER_ID IN (SELECT DISTINCT
      CUSTOMER_ID FROM FACT.FACT_SALES WHERE TotalAmount > 5000)
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 30
    total_executions: 380
    avg_duration_ms: 156.2
    last_execution_time: '2024-12-02T01:00:00'
