metadata:
  name: dim_product_comparative_validation
  description: Comparative validations from Query Store for dim.dim_product
  generated_from: workload_wl_20251202_060618_1a4c017a
  project_id: dw_validation
  created_at: '2025-12-02T06:06:21.156162'
  validation_count: 11
  validation_type: comparative
source:
  type: sqlserver
  database: ${SQL_DATABASE}
  schema: dim
  table: dim_product
target:
  type: snowflake
  database: ${SNOWFLAKE_DATABASE}
  schema: DIM
  table: DIM_PRODUCT
steps:
- name: comparative_validation_1_query_2
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    2)'
  enabled: true
  config:
    sql_server_query: SELECT COUNT(*) FROM dim.DIM_PRODUCT
    snowflake_query: SELECT COUNT(*) FROM DIM.DIM_PRODUCT
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 2
    total_executions: 980
    avg_duration_ms: 38.7
    last_execution_time: '2024-12-01T11:15:00'
- name: comparative_validation_2_query_7
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    7)'
  enabled: true
  config:
    sql_server_query: SELECT * FROM dim.DIM_PRODUCT WHERE category = 'Electronics'
    snowflake_query: SELECT * FROM DIM.DIM_PRODUCT WHERE CATEGORY = 'Electronics'
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 7
    total_executions: 680
    avg_duration_ms: 28.3
    last_execution_time: '2024-12-01T13:30:00'
- name: comparative_validation_3_query_10
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    10)'
  enabled: true
  config:
    sql_server_query: SELECT AVG(unit_price) FROM dim.DIM_PRODUCT
    snowflake_query: SELECT AVG(UNIT_PRICE) FROM DIM.DIM_PRODUCT
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 10
    total_executions: 890
    avg_duration_ms: 42.3
    last_execution_time: '2024-12-01T15:00:00'
- name: comparative_validation_4_query_13
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    13)'
  enabled: true
  config:
    sql_server_query: SELECT p.product_name, s.Quantity FROM dim.DIM_PRODUCT p INNER
      JOIN fact.FACT_SALES s ON p.product_id = s.product_id
    snowflake_query: SELECT p.PRODUCT_NAME, s.Quantity FROM DIM.DIM_PRODUCT p INNER
      JOIN FACT.FACT_SALES s ON p.PRODUCT_ID = s.PRODUCT_ID
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 13
    total_executions: 1350
    avg_duration_ms: 223.4
    last_execution_time: '2024-12-01T16:30:00'
- name: comparative_validation_5_query_16
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    16)'
  enabled: true
  config:
    sql_server_query: SELECT category, COUNT(*) FROM dim.DIM_PRODUCT GROUP BY category
    snowflake_query: SELECT CATEGORY, COUNT(*) FROM DIM.DIM_PRODUCT GROUP BY CATEGORY
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 16
    total_executions: 650
    avg_duration_ms: 56.8
    last_execution_time: '2024-12-01T18:00:00'
- name: comparative_validation_6_query_18
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    18)'
  enabled: true
  config:
    sql_server_query: SELECT * FROM dim.DIM_PRODUCT ORDER BY unit_price DESC
    snowflake_query: SELECT * FROM DIM.DIM_PRODUCT ORDER BY UNIT_PRICE DESC
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 18
    total_executions: 490
    avg_duration_ms: 67.4
    last_execution_time: '2024-12-01T19:00:00'
- name: comparative_validation_7_query_20
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    20)'
  enabled: true
  config:
    sql_server_query: SELECT c.CustomerName, p.product_name, s.TotalAmount FROM dim.DIM_CUSTOMER
      c INNER JOIN fact.FACT_SALES s ON c.CustomerID = s.CustomerID INNER JOIN dim.DIM_PRODUCT
      p ON s.product_id = p.product_id WHERE s.TotalAmount > 1000
    snowflake_query: SELECT c.CustomerName, p.PRODUCT_NAME, s.TotalAmount FROM DIM.DIM_CUSTOMER
      c INNER JOIN FACT.FACT_SALES s ON c.CustomerID = s.CustomerID INNER JOIN DIM.DIM_PRODUCT
      p ON s.PRODUCT_ID = p.PRODUCT_ID WHERE s.TotalAmount > 1000
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 20
    total_executions: 890
    avg_duration_ms: 312.8
    last_execution_time: '2024-12-01T20:00:00'
- name: comparative_validation_8_query_21
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    21)'
  enabled: true
  config:
    sql_server_query: SELECT DISTINCT category FROM dim.DIM_PRODUCT
    snowflake_query: SELECT DISTINCT CATEGORY FROM DIM.DIM_PRODUCT
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 21
    total_executions: 420
    avg_duration_ms: 48.2
    last_execution_time: '2024-12-01T20:30:00'
- name: comparative_validation_9_query_22
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    22)'
  enabled: true
  config:
    sql_server_query: SELECT * FROM dim.DIM_PRODUCT WHERE unit_price > 100 AND unit_price
      < 500
    snowflake_query: SELECT * FROM DIM.DIM_PRODUCT WHERE UNIT_PRICE > 100 AND UNIT_PRICE
      < 500
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 22
    total_executions: 580
    avg_duration_ms: 52.1
    last_execution_time: '2024-12-01T21:00:00'
- name: comparative_validation_10_query_24
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    24)'
  enabled: true
  config:
    sql_server_query: SELECT * FROM dim.DIM_PRODUCT WHERE category IN ('Electronics',
      'Clothing', 'Food')
    snowflake_query: SELECT * FROM DIM.DIM_PRODUCT WHERE CATEGORY IN ('Electronics',
      'Clothing', 'Food')
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 24
    total_executions: 460
    avg_duration_ms: 43.5
    last_execution_time: '2024-12-01T22:00:00'
- name: comparative_validation_11_query_29
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    29)'
  enabled: true
  config:
    sql_server_query: SELECT p.category, COUNT(*) AS ProductCount, AVG(p.unit_price)
      AS AvgPrice, SUM(ISNULL(s.Quantity, 0)) AS TotalSold FROM dim.DIM_PRODUCT p
      LEFT JOIN fact.FACT_SALES s ON p.product_id = s.product_id GROUP BY p.category
    snowflake_query: SELECT p.CATEGORY, COUNT(*) AS ProductCount, AVG(p.UNIT_PRICE)
      AS AvgPrice, SUM(COALESCE(s.Quantity, 0)) AS TotalSold FROM DIM.DIM_PRODUCT
      p LEFT JOIN FACT.FACT_SALES s ON p.PRODUCT_ID = s.PRODUCT_ID GROUP BY p.CATEGORY
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 29
    total_executions: 670
    avg_duration_ms: 289.4
    last_execution_time: '2024-12-02T00:30:00'
