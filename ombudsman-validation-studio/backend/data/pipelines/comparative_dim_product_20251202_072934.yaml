metadata:
  name: dim_product_comparative_validation
  description: Comparative validations from Query Store for dim.dim_product
  generated_from: workload_wl_20251202_072934
  project_id: dw_validation
  created_at: '2025-12-02T07:29:34.982295'
  validation_count: 14
  validation_type: comparative
source:
  type: sqlserver
  database: ${SQL_DATABASE}
  schema: dim
  table: dim_product
target:
  type: snowflake
  database: ${SNOWFLAKE_DATABASE}
  schema: DIM
  table: DIM_PRODUCT
steps:
- name: comparative_validation_1_query_1
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    1)'
  enabled: true
  config:
    sql_server_query: SELECT COUNT(*) FROM DIM.dim_customer
    snowflake_query: SELECT COUNT(*) FROM DIM.dim_customer
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 1
    total_executions: 1250
    avg_duration_ms: 45.3
    last_execution_time: '2024-12-01T10:30:00'
- name: comparative_validation_2_query_2
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    2)'
  enabled: true
  config:
    sql_server_query: SELECT COUNT(*) FROM DIM.dim_product
    snowflake_query: SELECT COUNT(*) FROM DIM.dim_product
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 2
    total_executions: 980
    avg_duration_ms: 38.7
    last_execution_time: '2024-12-01T11:15:00'
- name: comparative_validation_3_query_3
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    3)'
  enabled: true
  config:
    sql_server_query: SELECT COUNT(*) FROM DIM.dim_store
    snowflake_query: SELECT COUNT(*) FROM DIM.dim_store
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 3
    total_executions: 850
    avg_duration_ms: 32.1
    last_execution_time: '2024-12-01T11:45:00'
- name: comparative_validation_4_query_4
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    4)'
  enabled: true
  config:
    sql_server_query: SELECT COUNT(*) FROM FACT.fact_sales
    snowflake_query: SELECT COUNT(*) FROM FACT.fact_sales
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 4
    total_executions: 2100
    avg_duration_ms: 125.5
    last_execution_time: '2024-12-01T12:00:00'
- name: comparative_validation_5_query_5
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    5)'
  enabled: true
  config:
    sql_server_query: SELECT * FROM DIM.dim_product WHERE category = 'Electronics'
    snowflake_query: SELECT * FROM DIM.dim_product WHERE category = 'Electronics'
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 5
    total_executions: 680
    avg_duration_ms: 28.3
    last_execution_time: '2024-12-01T13:30:00'
- name: comparative_validation_6_query_6
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    6)'
  enabled: true
  config:
    sql_server_query: SELECT AVG(unit_price) FROM DIM.dim_product
    snowflake_query: SELECT AVG(unit_price) FROM DIM.dim_product
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 6
    total_executions: 890
    avg_duration_ms: 42.3
    last_execution_time: '2024-12-01T15:00:00'
- name: comparative_validation_7_query_7
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    7)'
  enabled: true
  config:
    sql_server_query: SELECT p.product_name, s.quantity FROM DIM.dim_product p INNER
      JOIN FACT.fact_sales s ON p.product_key = s.dim_product_key
    snowflake_query: SELECT p.product_name, s.quantity FROM DIM.dim_product p INNER
      JOIN FACT.fact_sales s ON p.product_key = s.dim_product_key
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 7
    total_executions: 1350
    avg_duration_ms: 223.4
    last_execution_time: '2024-12-01T16:30:00'
- name: comparative_validation_8_query_8
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    8)'
  enabled: true
  config:
    sql_server_query: SELECT category, COUNT(*) FROM DIM.dim_product GROUP BY category
    snowflake_query: SELECT category, COUNT(*) FROM DIM.dim_product GROUP BY category
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 8
    total_executions: 650
    avg_duration_ms: 56.8
    last_execution_time: '2024-12-01T18:00:00'
- name: comparative_validation_9_query_9
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    9)'
  enabled: true
  config:
    sql_server_query: SELECT * FROM DIM.dim_product ORDER BY unit_price DESC
    snowflake_query: SELECT * FROM DIM.dim_product ORDER BY unit_price DESC
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 9
    total_executions: 490
    avg_duration_ms: 67.4
    last_execution_time: '2024-12-01T19:00:00'
- name: comparative_validation_10_query_10
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    10)'
  enabled: true
  config:
    sql_server_query: SELECT c.customer_name, p.product_name, s.discount_amount FROM
      DIM.dim_customer c INNER JOIN FACT.fact_sales s ON c.customer_key = s.dim_customer_key
      INNER JOIN DIM.dim_product p ON s.dim_product_key = p.product_key WHERE s.discount_amount
      > 1000
    snowflake_query: SELECT c.customer_name, p.product_name, s.discount_amount FROM
      DIM.dim_customer c INNER JOIN FACT.fact_sales s ON c.customer_key = s.dim_customer_key
      INNER JOIN DIM.dim_product p ON s.dim_product_key = p.product_key WHERE s.discount_amount
      > 1000
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 10
    total_executions: 890
    avg_duration_ms: 312.8
    last_execution_time: '2024-12-01T20:00:00'
- name: comparative_validation_11_query_11
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    11)'
  enabled: true
  config:
    sql_server_query: SELECT DISTINCT category FROM DIM.dim_product
    snowflake_query: SELECT DISTINCT category FROM DIM.dim_product
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 11
    total_executions: 420
    avg_duration_ms: 48.2
    last_execution_time: '2024-12-01T20:30:00'
- name: comparative_validation_12_query_12
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    12)'
  enabled: true
  config:
    sql_server_query: SELECT * FROM DIM.dim_product WHERE unit_price > 100 AND unit_price
      < 500
    snowflake_query: SELECT * FROM DIM.dim_product WHERE unit_price > 100 AND unit_price
      < 500
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 12
    total_executions: 580
    avg_duration_ms: 52.1
    last_execution_time: '2024-12-01T21:00:00'
- name: comparative_validation_13_query_13
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    13)'
  enabled: true
  config:
    sql_server_query: SELECT * FROM DIM.dim_product WHERE category IN ('Electronics',
      'Clothing', 'Food')
    snowflake_query: SELECT * FROM DIM.dim_product WHERE category IN ('Electronics',
      'Clothing', 'Food')
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 13
    total_executions: 460
    avg_duration_ms: 43.5
    last_execution_time: '2024-12-01T22:00:00'
- name: comparative_validation_14_query_14
  type: comparative
  validator: custom_sql
  description: 'Compare query results between SQL Server and Snowflake (Query ID:
    14)'
  enabled: true
  config:
    sql_server_query: SELECT p.category, COUNT(*) AS ProductCount, AVG(p.unit_price)
      AS AvgPrice, SUM(ISNULL(s.quantity, 0)) AS TotalSold FROM DIM.dim_product p
      LEFT JOIN FACT.fact_sales s ON p.product_key = s.dim_product_key GROUP BY p.category
    snowflake_query: SELECT p.category, COUNT(*) AS ProductCount, AVG(p.unit_price)
      AS AvgPrice, SUM(ISNULL(s.quantity, 0)) AS TotalSold FROM DIM.dim_product p
      LEFT JOIN FACT.fact_sales s ON p.product_key = s.dim_product_key GROUP BY p.category
    compare_mode: result_set
    tolerance: 0.0
    ignore_column_order: true
    ignore_row_order: false
  metadata:
    query_id: 14
    total_executions: 670
    avg_duration_ms: 289.4
    last_execution_time: '2024-12-02T00:30:00'
